suspending on  Promise(id='foo', cid='hitl-foo')
here  Resume(id='foo', cid='hitl-foo', promise=DurablePromise(id='foo', state='RESOLVED', timeout=1790968914809, ikey_for_create='hitl-foo.1', ikey_for_complete=None, param=DurablePromiseValue(headers={'resonate:format-py': 'null'}, data=None), value=DurablePromiseValue(headers=None, data='1'), tags={}, created_on=1759432914809, completed_on=1759432915814), invoke=None)
resuming  Promise(id='foo', cid='hitl-foo')
Claim  __resume:hitl-foo:foo resume
suspending on  Promise(id='bar', cid='hitl-bar')

Resonate encountered an unexpected exception and had to shut down.

📦 Version:     0.6.5
🧵 Thread:      message-source
❌ Exception:   ResonateStoreError("The task TaskRecord(id='__resume:hitl-foo:foo', counter=1, state='COMPLETED', type='resume', recv='local://any@default/b95af45382b64389988110bb480c08b2', root_promise_id='hitl-foo', leaf_promise_id='foo', pid=None, ttl=None, expiry=None, created_on=1759432915814, completed_on=1759432915817) is already claimed, completed, or an invalid counter was provided CLAIMED")
📄 Stacktrace:
─────────────────────────────────────────────────────────────────────
Traceback (most recent call last):
  File "/Users/tomasperez/Documents/resonate/resonate-sdk-py/resonate/utils.py", line 22, in wrapper
    return func(*args, **kwargs)
  File "/Users/tomasperez/Documents/resonate/resonate-sdk-py/resonate/bridge.py", line 309, in _process_msgs
    root, leaf = self._store.tasks.claim(id=task.id, counter=task.counter, pid=self._pid, ttl=self._ttl * 1000)
                 ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tomasperez/Documents/resonate/resonate-sdk-py/resonate/stores/local.py", line 668, in claim
    task, applied = self.transition(id=id, to="CLAIMED", counter=counter, pid=pid, ttl=ttl)
                    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tomasperez/Documents/resonate/resonate-sdk-py/resonate/stores/local.py", line 921, in transition
    raise ResonateStoreError(mesg=f"The task {record} is already claimed, completed, or an invalid counter was provided {to}", code=40305)
resonate.errors.errors.ResonateStoreError: [100.40305] The task TaskRecord(id='__resume:hitl-foo:foo', counter=1, state='COMPLETED', type='resume', recv='local://any@default/b95af45382b64389988110bb480c08b2', root_promise_id='hitl-foo', leaf_promise_id='foo', pid=None, ttl=None, expiry=None, created_on=1759432915814, completed_on=1759432915817) is already claimed, completed, or an invalid counter was provided CLAIMED

─────────────────────────────────────────────────────────────────────

🔗 Please help us make resonate better by reporting this issue:
https://github.com/resonatehq/resonate-sdk-py/issues/new?body=%0AAn%20exception%20occurred%20in%20the%20resonate%20python%20sdk.%0A%0A%2A%2AVersion%2A%2A%0A%60%60%60%0A0.6.5%0A%60%60%60%0A%0A%2A%2AThread%2A%2A%0A%60%60%60%0Amessage-source%0A%60%60%60%0A%0A%2A%2AException%2A%2A%0A%60%60%60%0AResonateStoreError%28%22The%20task%20TaskRecord%28id%3D%27__resume%3Ahitl-foo%3Afoo%27%2C%20counter%3D1%2C%20state%3D%27COMPLETED%27%2C%20type%3D%27resume%27%2C%20recv%3D%27local%3A//any%40default/b95af45382b64389988110bb480c08b2%27%2C%20root_promise_id%3D%27hitl-foo%27%2C%20leaf_promise_id%3D%27foo%27%2C%20pid%3DNone%2C%20ttl%3DNone%2C%20expiry%3DNone%2C%20created_on%3D1759432915814%2C%20completed_on%3D1759432915817%29%20is%20already%20claimed%2C%20completed%2C%20or%20an%20invalid%20counter%20was%20provided%20CLAIMED%22%29%0A%60%60%60%0A%0A%2A%2AStacktrace%2A%2A%0A%60%60%60%0ATraceback%20%28most%20recent%20call%20last%29%3A%0A%20%20File%20%22/Users/tomasperez/Documents/resonate/resonate-sdk-py/resonate/utils.py%22%2C%20line%2022%2C%20in%20wrapper%0A%20%20%20%20return%20func%28%2Aargs%2C%20%2A%2Akwargs%29%0A%20%20File%20%22/Users/tomasperez/Documents/resonate/resonate-sdk-py/resonate/bridge.py%22%2C%20line%20309%2C%20in%20_process_msgs%0A%20%20%20%20root%2C%20leaf%20%3D%20self._store.tasks.claim%28id%3Dtask.id%2C%20counter%3Dtask.counter%2C%20pid%3Dself._pid%2C%20ttl%3Dself._ttl%20%2A%201000%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20~~~~~~~~~~~~~~~~~~~~~~~%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%0A%20%20File%20%22/Users/tomasperez/Documents/resonate/resonate-sdk-py/resonate/stores/local.py%22%2C%20line%20668%2C%20in%20claim%0A%20%20%20%20task%2C%20applied%20%3D%20self.transition%28id%3Did%2C%20to%3D%22CLAIMED%22%2C%20counter%3Dcounter%2C%20pid%3Dpid%2C%20ttl%3Dttl%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20~~~~~~~~~~~~~~~%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%0A%20%20File%20%22/Users/tomasperez/Documents/resonate/resonate-sdk-py/resonate/stores/local.py%22%2C%20line%20921%2C%20in%20transition%0A%20%20%20%20raise%20ResonateStoreError%28mesg%3Df%22The%20task%20%7Brecord%7D%20is%20already%20claimed%2C%20completed%2C%20or%20an%20invalid%20counter%20was%20provided%20%7Bto%7D%22%2C%20code%3D40305%29%0Aresonate.errors.errors.ResonateStoreError%3A%20%5B100.40305%5D%20The%20task%20TaskRecord%28id%3D%27__resume%3Ahitl-foo%3Afoo%27%2C%20counter%3D1%2C%20state%3D%27COMPLETED%27%2C%20type%3D%27resume%27%2C%20recv%3D%27local%3A//any%40default/b95af45382b64389988110bb480c08b2%27%2C%20root_promise_id%3D%27hitl-foo%27%2C%20leaf_promise_id%3D%27foo%27%2C%20pid%3DNone%2C%20ttl%3DNone%2C%20expiry%3DNone%2C%20created_on%3D1759432915814%2C%20completed_on%3D1759432915817%29%20is%20already%20claimed%2C%20completed%2C%20or%20an%20invalid%20counter%20was%20provided%20CLAIMED%0A%0A%60%60%60%0A%0A%2A%2AAdditional%20context%2A%2A%0APlease%20provide%20any%20additional%20context%20that%20might%20help%20us%20debug%20this%20issue.%0A
